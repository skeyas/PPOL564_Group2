{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a358810a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "5f8fc4d3e47243eeb48838027f581ac3",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/2125561 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Full documentation available at:\n",
    "# https://apidocs.redivis.com/client-libraries/redivis-python\n",
    "\n",
    "import redivis\n",
    "## repeated printouts\n",
    "from IPython.core.interactiveshell import InteractiveShell\n",
    "InteractiveShell.ast_node_interactivity = \"all\"\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "#CDC Places preliminary loading & cleaning\n",
    "table = redivis.table(\"places_census_tract_data_2021_release:gcty\")  # Reference any table in this project\n",
    "cdc = table.to_dataframe()    # Load table as a dataframe\n",
    "\n",
    "cdc.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f97cb155-5a9b-4fe9-8c0b-8dbf31375281",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>StateAbbr</th>\n",
       "      <th>CountyName</th>\n",
       "      <th>CountyFIPS</th>\n",
       "      <th>LocationName</th>\n",
       "      <th>Measure</th>\n",
       "      <th>Data_Value</th>\n",
       "      <th>Data_Value_Unit</th>\n",
       "      <th>TotalPopulation</th>\n",
       "      <th>Geolocation</th>\n",
       "      <th>LocationID</th>\n",
       "      <th>value_numeric</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>AK</td>\n",
       "      <td>Kenai Peninsula</td>\n",
       "      <td>02122</td>\n",
       "      <td>02122000400</td>\n",
       "      <td>Current asthma among adults aged &gt;=18 years</td>\n",
       "      <td>9.4</td>\n",
       "      <td>%</td>\n",
       "      <td>6497</td>\n",
       "      <td>POINT (-150.52710 60.21556)</td>\n",
       "      <td>02122000400</td>\n",
       "      <td>610.718</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201</th>\n",
       "      <td>AK</td>\n",
       "      <td>Anchorage</td>\n",
       "      <td>02020</td>\n",
       "      <td>02020002603</td>\n",
       "      <td>Current asthma among adults aged &gt;=18 years</td>\n",
       "      <td>9.1</td>\n",
       "      <td>%</td>\n",
       "      <td>6341</td>\n",
       "      <td>POINT (-149.81920 61.14473)</td>\n",
       "      <td>02020002603</td>\n",
       "      <td>577.031</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    StateAbbr       CountyName CountyFIPS LocationName  \\\n",
       "200        AK  Kenai Peninsula      02122  02122000400   \n",
       "201        AK        Anchorage      02020  02020002603   \n",
       "\n",
       "                                         Measure Data_Value Data_Value_Unit  \\\n",
       "200  Current asthma among adults aged >=18 years        9.4               %   \n",
       "201  Current asthma among adults aged >=18 years        9.1               %   \n",
       "\n",
       "     TotalPopulation                  Geolocation   LocationID  value_numeric  \n",
       "200             6497  POINT (-150.52710 60.21556)  02122000400        610.718  \n",
       "201             6341  POINT (-149.81920 61.14473)  02020002603        577.031  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Filter to one year and asthma only\n",
    "cdc_analysis_1 = cdc[(cdc.Year==2019) & (cdc.Short_Question_Text=='Current Asthma')].copy()\n",
    "\n",
    "#subset to relevant columns\n",
    "cdc_analysis = cdc_analysis_1[['StateAbbr','CountyName','CountyFIPS',\n",
    "                                            'LocationName','Measure','Data_Value',\n",
    "                                             'Data_Value_Unit','TotalPopulation',\n",
    "                                             'Geolocation','LocationID']].copy()\n",
    "#Calculate absolute value of population with asthma\n",
    "cdc_analysis['value_numeric'] = cdc_analysis.Data_Value.astype(float) *\\\n",
    "                                cdc_analysis.TotalPopulation.astype(float) *0.01\n",
    "cdc_analysis.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "10577056-39ea-42aa-8832-d21d8ab0d6f9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/6589958 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Load PM2.5 (TBD if needed) from AQI\n",
    "table2 = redivis.table(\"daily_pm2_5_frm_fem_mass_summary_data:gy9e\")  # Reference any table in this project\n",
    "pm25 = table2.to_dataframe()      # Load table as a dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "57b32bbe-71ce-4c29-827c-4318bf71a930",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/5513939 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "table3 = redivis.table(\"daily_pm25_non_frm_fem_mass_summary_data:39ez\")  # Reference any table in this project\n",
    "pm25_non_frm_fem = table3.to_dataframe() # Load table as a dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "0b09f4f4-7184-402d-8d0c-84df8a938e51",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/80936 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 80936 entries, 0 to 80935\n",
      "Columns: 118 entries, _1__YEAR to _118__8_9___PRODUCTION_RATIO\n",
      "dtypes: float64(61), int64(15), string(42)\n",
      "memory usage: 72.9 MB\n"
     ]
    }
   ],
   "source": [
    "#Load TRI data\n",
    "table4 = redivis.table(\"tri_basic_data_file_2018:j46z\")  # Reference any table in this project\n",
    "tri = table4.to_dataframe()      # Load table as a dataframe\n",
    "tri.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "b3b03c3f-90d9-4f29-9d2d-db6f0029b4f6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['_48__5_2___STACK_AIR']"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list_tri = tri.columns\n",
    "list(filter(lambda k: '47' in k, list_tri))\n",
    "list(filter(lambda k: '48' in k, list_tri))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "2b794cce-2e96-4187-845e-58c58b28d4cf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_1__YEAR</th>\n",
       "      <th>_2__TRIFD</th>\n",
       "      <th>_3__FRS_ID</th>\n",
       "      <th>_4__FACILITY_NAME</th>\n",
       "      <th>_5__STREET_ADDRESS</th>\n",
       "      <th>_6__CITY</th>\n",
       "      <th>_7__COUNTY</th>\n",
       "      <th>_8__ST</th>\n",
       "      <th>_9__ZIP</th>\n",
       "      <th>_10__BIA</th>\n",
       "      <th>...</th>\n",
       "      <th>_111__8_4___RECYCLING_ON_SITE</th>\n",
       "      <th>_112__8_5___RECYCLING_OFF_SIT</th>\n",
       "      <th>_113__8_6___TREATMENT_ON_SITE</th>\n",
       "      <th>_114__8_7___TREATMENT_OFF_SITE</th>\n",
       "      <th>_115__PRODUCTION_WSTE__8_1_8_7_</th>\n",
       "      <th>_116__8_8___ONE_TIME_RELEASE</th>\n",
       "      <th>_117__PROD_RATIO_OR__ACTIVITY</th>\n",
       "      <th>_118__8_9___PRODUCTION_RATIO</th>\n",
       "      <th>coordinate</th>\n",
       "      <th>air_pollution</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018</td>\n",
       "      <td>00617PRCSNTMASD</td>\n",
       "      <td>110025330666</td>\n",
       "      <td>ADM ALLIANCE NUTRITION OF PUERTO RICO LLC</td>\n",
       "      <td>TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>PR</td>\n",
       "      <td>00617</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>(18.452756,-66.540381)</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018</td>\n",
       "      <td>00617PRCSNTMASD</td>\n",
       "      <td>110025330666</td>\n",
       "      <td>ADM ALLIANCE NUTRITION OF PUERTO RICO LLC</td>\n",
       "      <td>TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>PR</td>\n",
       "      <td>00617</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>(18.452756,-66.540381)</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018</td>\n",
       "      <td>00617PRCSNTMASD</td>\n",
       "      <td>110025330666</td>\n",
       "      <td>ADM ALLIANCE NUTRITION OF PUERTO RICO LLC</td>\n",
       "      <td>TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>PR</td>\n",
       "      <td>00617</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>(18.452756,-66.540381)</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018</td>\n",
       "      <td>00617PRCSNTMASD</td>\n",
       "      <td>110025330666</td>\n",
       "      <td>ADM ALLIANCE NUTRITION OF PUERTO RICO LLC</td>\n",
       "      <td>TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>PR</td>\n",
       "      <td>00617</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.11</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.66</td>\n",
       "      <td>(18.452756,-66.540381)</td>\n",
       "      <td>0.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018</td>\n",
       "      <td>00617PRCSNTMASD</td>\n",
       "      <td>110025330666</td>\n",
       "      <td>ADM ALLIANCE NUTRITION OF PUERTO RICO LLC</td>\n",
       "      <td>TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>BARCELONETA</td>\n",
       "      <td>PR</td>\n",
       "      <td>00617</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>NA</td>\n",
       "      <td>(18.452756,-66.540381)</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80931</th>\n",
       "      <td>2018</td>\n",
       "      <td>9990WCRWLY9STED</td>\n",
       "      <td>110070671335</td>\n",
       "      <td>CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY</td>\n",
       "      <td>900 STEDMAN ST</td>\n",
       "      <td>KETCHIKAN</td>\n",
       "      <td>KETCHIKAN GATEWAY BOROUGH</td>\n",
       "      <td>AK</td>\n",
       "      <td>99901</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>583.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.99</td>\n",
       "      <td>(55.3376,-131.63331)</td>\n",
       "      <td>583.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80932</th>\n",
       "      <td>2018</td>\n",
       "      <td>9990WCRWLY9STED</td>\n",
       "      <td>110070671335</td>\n",
       "      <td>CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY</td>\n",
       "      <td>900 STEDMAN ST</td>\n",
       "      <td>KETCHIKAN</td>\n",
       "      <td>KETCHIKAN GATEWAY BOROUGH</td>\n",
       "      <td>AK</td>\n",
       "      <td>99901</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>198.00</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.99</td>\n",
       "      <td>(55.3376,-131.63331)</td>\n",
       "      <td>198.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80933</th>\n",
       "      <td>2018</td>\n",
       "      <td>9990WCRWLY9STED</td>\n",
       "      <td>110070671335</td>\n",
       "      <td>CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY</td>\n",
       "      <td>900 STEDMAN ST</td>\n",
       "      <td>KETCHIKAN</td>\n",
       "      <td>KETCHIKAN GATEWAY BOROUGH</td>\n",
       "      <td>AK</td>\n",
       "      <td>99901</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.74</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.99</td>\n",
       "      <td>(55.3376,-131.63331)</td>\n",
       "      <td>0.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80934</th>\n",
       "      <td>2018</td>\n",
       "      <td>9990WCRWLY9STED</td>\n",
       "      <td>110070671335</td>\n",
       "      <td>CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY</td>\n",
       "      <td>900 STEDMAN ST</td>\n",
       "      <td>KETCHIKAN</td>\n",
       "      <td>KETCHIKAN GATEWAY BOROUGH</td>\n",
       "      <td>AK</td>\n",
       "      <td>99901</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.09</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.99</td>\n",
       "      <td>(55.3376,-131.63331)</td>\n",
       "      <td>0.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80935</th>\n",
       "      <td>2018</td>\n",
       "      <td>9990WCRWLY9STED</td>\n",
       "      <td>110070671335</td>\n",
       "      <td>CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY</td>\n",
       "      <td>900 STEDMAN ST</td>\n",
       "      <td>KETCHIKAN</td>\n",
       "      <td>KETCHIKAN GATEWAY BOROUGH</td>\n",
       "      <td>AK</td>\n",
       "      <td>99901</td>\n",
       "      <td>NA</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>14.30</td>\n",
       "      <td>NA</td>\n",
       "      <td>PRODUCTION</td>\n",
       "      <td>0.99</td>\n",
       "      <td>(55.3376,-131.63331)</td>\n",
       "      <td>14.30</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>80936 rows Ã— 120 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       _1__YEAR        _2__TRIFD    _3__FRS_ID  \\\n",
       "0          2018  00617PRCSNTMASD  110025330666   \n",
       "1          2018  00617PRCSNTMASD  110025330666   \n",
       "2          2018  00617PRCSNTMASD  110025330666   \n",
       "3          2018  00617PRCSNTMASD  110025330666   \n",
       "4          2018  00617PRCSNTMASD  110025330666   \n",
       "...         ...              ...           ...   \n",
       "80931      2018  9990WCRWLY9STED  110070671335   \n",
       "80932      2018  9990WCRWLY9STED  110070671335   \n",
       "80933      2018  9990WCRWLY9STED  110070671335   \n",
       "80934      2018  9990WCRWLY9STED  110070671335   \n",
       "80935      2018  9990WCRWLY9STED  110070671335   \n",
       "\n",
       "                                  _4__FACILITY_NAME  \\\n",
       "0         ADM ALLIANCE NUTRITION OF PUERTO RICO LLC   \n",
       "1         ADM ALLIANCE NUTRITION OF PUERTO RICO LLC   \n",
       "2         ADM ALLIANCE NUTRITION OF PUERTO RICO LLC   \n",
       "3         ADM ALLIANCE NUTRITION OF PUERTO RICO LLC   \n",
       "4         ADM ALLIANCE NUTRITION OF PUERTO RICO LLC   \n",
       "...                                             ...   \n",
       "80931  CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY   \n",
       "80932  CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY   \n",
       "80933  CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY   \n",
       "80934  CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY   \n",
       "80935  CROWLEY KETCHIKAN BULK FUEL STORAGE FACILITY   \n",
       "\n",
       "                                      _5__STREET_ADDRESS     _6__CITY  \\\n",
       "0      TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...  BARCELONETA   \n",
       "1      TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...  BARCELONETA   \n",
       "2      TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...  BARCELONETA   \n",
       "3      TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...  BARCELONETA   \n",
       "4      TOMAS DAVILA ST EDIF 10  PALMAS ALTAS INDUSTRI...  BARCELONETA   \n",
       "...                                                  ...          ...   \n",
       "80931                                     900 STEDMAN ST    KETCHIKAN   \n",
       "80932                                     900 STEDMAN ST    KETCHIKAN   \n",
       "80933                                     900 STEDMAN ST    KETCHIKAN   \n",
       "80934                                     900 STEDMAN ST    KETCHIKAN   \n",
       "80935                                     900 STEDMAN ST    KETCHIKAN   \n",
       "\n",
       "                      _7__COUNTY _8__ST _9__ZIP _10__BIA  ...  \\\n",
       "0                    BARCELONETA     PR   00617       NA  ...   \n",
       "1                    BARCELONETA     PR   00617       NA  ...   \n",
       "2                    BARCELONETA     PR   00617       NA  ...   \n",
       "3                    BARCELONETA     PR   00617       NA  ...   \n",
       "4                    BARCELONETA     PR   00617       NA  ...   \n",
       "...                          ...    ...     ...      ...  ...   \n",
       "80931  KETCHIKAN GATEWAY BOROUGH     AK   99901       NA  ...   \n",
       "80932  KETCHIKAN GATEWAY BOROUGH     AK   99901       NA  ...   \n",
       "80933  KETCHIKAN GATEWAY BOROUGH     AK   99901       NA  ...   \n",
       "80934  KETCHIKAN GATEWAY BOROUGH     AK   99901       NA  ...   \n",
       "80935  KETCHIKAN GATEWAY BOROUGH     AK   99901       NA  ...   \n",
       "\n",
       "      _111__8_4___RECYCLING_ON_SITE  _112__8_5___RECYCLING_OFF_SIT  \\\n",
       "0                               0.0                            0.0   \n",
       "1                               0.0                            0.0   \n",
       "2                               0.0                            0.0   \n",
       "3                               0.0                            0.0   \n",
       "4                               0.0                            0.0   \n",
       "...                             ...                            ...   \n",
       "80931                           0.0                            0.0   \n",
       "80932                           0.0                            0.0   \n",
       "80933                           0.0                            0.0   \n",
       "80934                           0.0                            0.0   \n",
       "80935                           0.0                            0.0   \n",
       "\n",
       "       _113__8_6___TREATMENT_ON_SITE _114__8_7___TREATMENT_OFF_SITE  \\\n",
       "0                                0.0                            0.0   \n",
       "1                                0.0                            0.0   \n",
       "2                                0.0                            0.0   \n",
       "3                                0.0                            0.0   \n",
       "4                                0.0                            0.0   \n",
       "...                              ...                            ...   \n",
       "80931                            0.0                            0.0   \n",
       "80932                            0.0                            0.0   \n",
       "80933                            0.0                            0.0   \n",
       "80934                            0.0                            0.0   \n",
       "80935                            0.0                            0.0   \n",
       "\n",
       "      _115__PRODUCTION_WSTE__8_1_8_7_ _116__8_8___ONE_TIME_RELEASE  \\\n",
       "0                                0.00                           NA   \n",
       "1                                0.00                           NA   \n",
       "2                                0.00                           NA   \n",
       "3                                0.11                           NA   \n",
       "4                                0.00                           NA   \n",
       "...                               ...                          ...   \n",
       "80931                          583.00                           NA   \n",
       "80932                          198.00                           NA   \n",
       "80933                            0.74                           NA   \n",
       "80934                            0.09                           NA   \n",
       "80935                           14.30                           NA   \n",
       "\n",
       "      _117__PROD_RATIO_OR__ACTIVITY _118__8_9___PRODUCTION_RATIO  \\\n",
       "0                                NA                           NA   \n",
       "1                                NA                           NA   \n",
       "2                                NA                           NA   \n",
       "3                        PRODUCTION                         0.66   \n",
       "4                                NA                           NA   \n",
       "...                             ...                          ...   \n",
       "80931                    PRODUCTION                         0.99   \n",
       "80932                    PRODUCTION                         0.99   \n",
       "80933                    PRODUCTION                         0.99   \n",
       "80934                    PRODUCTION                         0.99   \n",
       "80935                    PRODUCTION                         0.99   \n",
       "\n",
       "                   coordinate air_pollution  \n",
       "0      (18.452756,-66.540381)          0.00  \n",
       "1      (18.452756,-66.540381)          0.00  \n",
       "2      (18.452756,-66.540381)          0.00  \n",
       "3      (18.452756,-66.540381)          0.11  \n",
       "4      (18.452756,-66.540381)          0.00  \n",
       "...                       ...           ...  \n",
       "80931    (55.3376,-131.63331)        583.00  \n",
       "80932    (55.3376,-131.63331)        198.00  \n",
       "80933    (55.3376,-131.63331)          0.74  \n",
       "80934    (55.3376,-131.63331)          0.09  \n",
       "80935    (55.3376,-131.63331)         14.30  \n",
       "\n",
       "[80936 rows x 120 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Create coordinate from lat & long\n",
    "tri['coordinate']='(' + tri._12__LATITUDE.astype(str) + ',' +\\\n",
    "                    tri._13__LONGITUDE.astype(str) + ')'\n",
    "#Summarize total air pollution\n",
    "tri['air_pollution'] = tri._47__5_1___FUGITIVE_AIR.astype(float) +\\\n",
    "                       tri._48__5_2___STACK_AIR.astype(float)\n",
    "\n",
    "tri"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
